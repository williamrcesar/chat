<% content_for :title, "Templates" %>

<div class="flex h-screen bg-[#111b21]">
  <div class="w-full max-w-4xl mx-auto p-6 overflow-y-auto">

    <div class="flex items-center justify-between mb-8">
      <div class="flex items-center gap-4">
        <%= link_to root_path, class: "text-[#8696a0] hover:text-white transition-colors" do %>
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
          </svg>
        <% end %>
        <h1 class="text-white text-xl font-medium">Templates de Mensagem</h1>
      </div>
      <%= link_to new_template_path, class: "flex items-center gap-2 bg-[#00a884] hover:bg-[#02966f] text-white text-sm font-semibold px-4 py-2 rounded-lg transition-colors" do %>
        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
        </svg>
        Novo Template
      <% end %>
    </div>

    <% if @templates.empty? %>
      <div class="text-center text-[#8696a0] py-16">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 mx-auto mb-4 opacity-30" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M4 6h16M4 10h16M4 14h10" />
        </svg>
        <p>Nenhum template criado ainda.</p>
      </div>
    <% end %>

    <div class="grid gap-4">
      <% Template::CATEGORIES.each do |category| %>
        <% category_templates = @templates.select { |t| t.category == category } %>
        <% next if category_templates.empty? %>

        <div>
          <h2 class="text-[#00a884] text-xs font-semibold uppercase tracking-wide mb-3"><%= category %></h2>
          <div class="space-y-2">
            <% category_templates.each do |template| %>
              <div class="bg-[#202c33] rounded-xl p-4 flex items-start justify-between gap-4">
                <div class="flex-1 min-w-0">
                  <h3 class="text-white font-medium text-sm mb-1"><%= template.name %></h3>
                  <p class="text-[#8696a0] text-sm leading-relaxed"><%= template.content.truncate(120) %></p>
                  <% if template.variables.any? %>
                    <div class="flex flex-wrap gap-1 mt-2">
                      <% template.variables.each do |var| %>
                        <span class="bg-[#2a3942] text-[#00a884] text-xs px-2 py-0.5 rounded">{{<%= var %>}}</span>
                      <% end %>
                    </div>
                  <% end %>
                </div>
                <div class="flex items-center gap-2 flex-shrink-0">
                  <%= link_to edit_template_path(template), class: "text-[#8696a0] hover:text-white transition-colors" do %>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                    </svg>
                  <% end %>
                  <%= button_to template_path(template), method: :delete,
                        data: { turbo_confirm: "Remover este template?" },
                        class: "text-[#8696a0] hover:text-red-400 transition-colors" do %>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                    </svg>
                  <% end %>
                </div>
              </div>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>
